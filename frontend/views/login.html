<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PrimeVision - Sign In</title>
<style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
        min-height: 100vh; display:flex; align-items:center; justify-content:center;
        overflow-x:hidden; position:relative;
    }
    .bg-particles { position:absolute; top:0; left:0; width:100%; height:100%; overflow:hidden; z-index:1; }
    .particle { position:absolute; background: linear-gradient(45deg,#33E0B2,#2BC4A0); border-radius:50%; opacity:0.1; animation: float 6s ease-in-out infinite; }
    .particle:nth-child(1){width:80px;height:80px;top:20%;left:10%;animation-delay:0s;}
    .particle:nth-child(2){width:60px;height:60px;top:60%;left:80%;animation-delay:2s;}
    .particle:nth-child(3){width:40px;height:40px;top:80%;left:20%;animation-delay:4s;}
    .particle:nth-child(4){width:100px;height:100px;top:10%;left:70%;animation-delay:1s;}
    .particle:nth-child(5){width:50px;height:50px;top:40%;left:60%;animation-delay:3s;}
    @keyframes float {0%,100%{transform:translateY(0) rotate(0deg);}50%{transform:translateY(-20px) rotate(180deg);}}
    
    .auth-container {
        background: rgba(26,26,46,0.95); backdrop-filter: blur(20px);
        border:1px solid rgba(51,224,178,0.2); border-radius:24px; padding:3rem;
        width:100%; max-width:450px;
        box-shadow: 0 25px 50px rgba(0,0,0,0.5),0 0 0 1px rgba(255,255,255,0.05),inset 0 1px 0 rgba(255,255,255,0.1);
        transform:translateY(0); transition: all 0.3s ease; position:relative; z-index:10;
    }
    .auth-container:hover { transform:translateY(-5px); box-shadow: 0 35px 70px rgba(0,0,0,0.6),0 0 0 1px rgba(51,224,178,0.3),inset 0 1px 0 rgba(255,255,255,0.1);}
    
    .logo { text-align:center; margin-bottom:2rem;}
    .logo h1 { color:#33E0B2; font-size:2.5rem; font-weight:700; text-shadow:0 0 20px rgba(51,224,178,0.5); margin-bottom:0.5rem;}
    .logo p { color:#8892b0; font-size:0.9rem; font-weight:300;}
    
    .auth-tabs { display:flex; background: rgba(0,0,0,0.3); border-radius:12px; padding:4px; margin-bottom:2rem; }
    .tab-button { flex:1; background:none; border:none; color:#8892b0; padding:12px 20px; border-radius:8px; cursor:pointer; transition: all 0.3s ease; font-weight:500; position:relative; z-index:2;}
    .tab-button.active { color:#fff; background: linear-gradient(135deg,#33E0B2,#2BC4A0); box-shadow:0 4px 15px rgba(51,224,178,0.3);}
    
    .form-group { margin-bottom:1.5rem; position:relative; }
    .form-input { width:100%; background: rgba(0,0,0,0.4); border:2px solid rgba(255,255,255,0.1); border-radius:12px; padding:16px 20px; color:#fff; font-size:1rem; transition: all 0.3s ease; outline:none; }
    .form-input:focus { border-color:#33E0B2; box-shadow:0 0 0 3px rgba(51,224,178,0.1); background:rgba(0,0,0,0.6);}
    .form-input::placeholder { color:#8892b0; transition: all 0.3s ease;}
    .form-input:focus::placeholder { opacity:0.7; transform:translateY(-2px);}
    
    .password-toggle { position:absolute; right:15px; top:50%; transform:translateY(-50%); background:none; border:none; color:#8892b0; cursor:pointer; font-size:1.1rem; transition: color 0.3s ease;}
    .password-toggle:hover { color:#33E0B2; }
    
    .form-options { display:flex; justify-content:space-between; align-items:center; margin-bottom:2rem; font-size:0.9rem;}
    .checkbox-group { display:flex; align-items:center; gap:8px;}
    .checkbox-group input[type="checkbox"] { width:18px; height:18px; accent-color:#33E0B2;}
    .checkbox-group label { color:#8892b0; cursor:pointer;}
    .forgot-password { color:#33E0B2; text-decoration:none; transition: all 0.3s ease;}
    .forgot-password:hover { color:#2BC4A0; text-shadow:0 0 8px rgba(51,224,178,0.5);}
    
    .submit-btn { width:100%; background:linear-gradient(135deg,#33E0B2,#2BC4A0); border:none; border-radius:12px; padding:16px; color:#fff; font-size:1.1rem; font-weight:600; cursor:pointer; transition: all 0.3s ease; position:relative; overflow:hidden;}
    .submit-btn:hover { transform:translateY(-2px); box-shadow:0 10px 25px rgba(51,224,178,0.4);}
    .submit-btn:active { transform:translateY(0);}
    .submit-btn::before { content:''; position:absolute; top:0; left:-100%; width:100%; height:100%; background:linear-gradient(90deg,transparent,rgba(255,255,255,0.2),transparent); transition:left 0.5s ease;}
    .submit-btn:hover::before { left:100%;}
    
    .divider { display:flex; align-items:center; margin:2rem 0; color:#8892b0; font-size:0.9rem; }
    .divider::before,.divider::after { content:''; flex:1; height:1px; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);}
    .divider span { padding:0 1rem;}
    
    .social-login { display:flex; gap:1rem; margin-bottom:2rem; }
    .social-btn { flex:1; background:rgba(0,0,0,0.4); border:2px solid rgba(255,255,255,0.1); border-radius:12px; padding:12px; color:#fff; cursor:pointer; transition: all 0.3s ease; display:flex; align-items:center; justify-content:center; gap:8px; font-weight:500;}
    .social-btn:hover { border-color:#33E0B2; background:rgba(51,224,178,0.1); transform:translateY(-2px);}
    
    .auth-footer { text-align:center; color:#8892b0; font-size:0.9rem;}
    .auth-footer a { color:#33E0B2; text-decoration:none; font-weight:500; transition: all 0.3s ease;}
    .auth-footer a:hover { color:#2BC4A0; text-shadow:0 0 8px rgba(51,224,178,0.5);}
    
    .back-to-home { position:absolute; top:2rem; left:2rem; color:#8892b0; text-decoration:none; display:flex; align-items:center; gap:0.5rem; transition: all 0.3s ease; z-index:100;}
    .back-to-home:hover { color:#33E0B2; }
    
    /* Responsive */
    @media(max-width:768px){.auth-container{margin:1rem;padding:2rem;max-width:none;}.logo h1{font-size:2rem;}.social-login{flex-direction:column;}.form-options{flex-direction:column;gap:1rem;align-items:flex-start;}}
    @media(max-width:480px){.auth-container{padding:1.5rem;}.logo h1{font-size:1.8rem;}.tab-button{padding:10px 16px;font-size:0.9rem;}}
    
    /* Loading animation */
    .loading { display:none; width:20px; height:20px; border:2px solid rgba(255,255,255,0.3); border-radius:50%; border-top-color:#fff; animation: spin 1s ease-in-out infinite;}
    @keyframes spin { to{ transform:rotate(360deg); } }
    .submit-btn.loading .loading { display:inline-block; }
    .submit-btn.loading .btn-text { display:none; }
</style>
</head>
<body>
<a href="../index.html" class="back-to-home">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
    Back to Home
</a>

<div class="bg-particles">
    <div class="particle"></div>
    <div class="particle"></div>
    <div class="particle"></div>
    <div class="particle"></div>
    <div class="particle"></div>
</div>

<div class="auth-container">
    <div class="logo">
        <h1>PrimeVision</h1>
        <p>Your AI-Powered Streaming Experience</p>
    </div>

    <div class="auth-tabs">
        <button class="tab-button active" data-tab="signin">Sign In</button>
        <button class="tab-button" data-tab="signup">Sign Up</button>
    </div>

    <form id="authForm">
        <div id="signupFields" style="display:none;">
            <div class="form-group">
                <input type="text" id="fullName" class="form-input" placeholder="Full Name" required>
            </div>
        </div>

        <div class="form-group">
            <input type="email" id="email" class="form-input" placeholder="Email Address" required>
        </div>

        <div class="form-group">
            <input type="password" id="password" class="form-input" placeholder="Password" required>
            <button type="button" class="password-toggle">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                    <circle cx="12" cy="12" r="3"/>
                </svg>
            </button>
        </div>

        <div id="signupPasswordConfirm" style="display:none;">
            <div class="form-group">
                <input type="password" id="confirmPassword" class="form-input" placeholder="Confirm Password" required>
                <button type="button" class="password-toggle">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                        <circle cx="12" cy="12" r="3"/>
                    </svg>
                </button>
            </div>
        </div>

        <div class="form-options">
            <div class="checkbox-group">
                <input type="checkbox" id="remember">
                <label for="remember">Remember me</label>
            </div>
            <a href="#" class="forgot-password">Forgot Password?</a>
        </div>

        <button type="submit" class="submit-btn">
            <span class="btn-text">Sign In</span>
            <div class="loading"></div>
        </button>
    </form>
    <div id="status-message"></div>

    <div class="divider"><span>or continue with</span></div>

    <div class="social-login">
        <button class="social-btn">
            <svg width="20" height="20" viewBox="0 0 24 24">
                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
            </svg> Google
        </button>
        <button class="social-btn">
            <svg width="20" height="20" viewBox="0 0 24 24">
                <path fill="#1877F2" d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
            </svg> Facebook
        </button>
    </div>

    <div class="auth-footer">
        <p id="authFooterText">Don't have an account? <a href="#" id="authToggle">Sign up here</a></p>
    </div>
</div>

<script>
const tabButtons = document.querySelectorAll('.tab-button');
const signupFields = document.getElementById('signupFields');
const signupPasswordConfirm = document.getElementById('signupPasswordConfirm');
const submitButton = document.querySelector('.submit-btn');
const submitButtonText = submitButton.querySelector('.btn-text');
const authFooterText = document.getElementById('authFooterText');
const authForm = document.getElementById('authForm');
const statusMessage = document.getElementById('status-message');

let isSignUp = false;

// Helper function to display status messages
function showStatusMessage(message, type) {
    statusMessage.textContent = message;
    statusMessage.className = `status-message ${type}`;
}

// Tab switching
tabButtons.forEach(button => {
    button.addEventListener('click', () => {
        tabButtons.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
        const tab = button.getAttribute('data-tab');
        toggleAuthMode(tab === 'signup');
    });
});

// Toggle Sign In / Sign Up
function toggleAuthMode(signUp) {
    isSignUp = signUp;
    if(signUp){
        signupFields.style.display='block';
        signupPasswordConfirm.style.display='block';
        submitButtonText.textContent='Create Account';
        authFooterText.innerHTML='Already have an account? <a href="#" id="authToggle">Sign in here</a>';
    } else {
        signupFields.style.display='none';
        signupPasswordConfirm.style.display='none';
        submitButtonText.textContent='Sign In';
        authFooterText.innerHTML='Don\'t have an account? <a href="#" id="authToggle">Sign up here</a>';
    }
    
    // Re-attach toggle click listener
    const currentAuthToggle = document.getElementById('authToggle');
    if (currentAuthToggle) {
        currentAuthToggle.addEventListener('click', e => {
            e.preventDefault();
            toggleAuthMode(!isSignUp);
        });
    }
    // Clear any previous status messages
    showStatusMessage('', '');
}

// Show / hide password
document.querySelectorAll('.password-toggle').forEach(btn => {
    btn.addEventListener('click', () => {
        const input = btn.previousElementSibling;
        input.type = input.type === 'password' ? 'text' : 'password';
    });
});

// Form submit
authForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    submitButton.classList.add('loading');
    showStatusMessage('Processing...', '');

    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    let fullName, confirmPassword;

    if(isSignUp){
        fullName = document.getElementById("fullName").value;
        confirmPassword = document.getElementById("confirmPassword").value;

        if(password !== confirmPassword){
            showStatusMessage("Passwords do not match.", 'error');
            submitButton.classList.remove('loading');
            return;
        }
    }
    
    // Set up the correct endpoint based on the form state
    const endpoint = isSignUp
        ? 'http://localhost:5000/auth/signup'
        : 'http://localhost:5000/auth/login';
    
    const payload = isSignUp
        ? { fullName, email, password, confirmPassword }
        : { email, password };

    try {
        const res = await fetch(endpoint, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });
        const data = await res.json();

        if (res.ok) {
            if (isSignUp) {
                showStatusMessage(data.message || "Account created successfully! Please sign in.", 'success');
                const signInButton = document.querySelector('.tab-button[data-tab="signin"]');
                if (signInButton) {
                    signInButton.click();
                }
            } else {
                // Store the token and redirect to dashboard
                localStorage.setItem('userToken', data.token);
                showStatusMessage("Login successful! Redirecting...", 'success');
                setTimeout(() => {
                    window.location.href = '../index.html';
                }, 1000);
            }
        } else {
            // Handle server-side errors
            showStatusMessage(data.message || "An error occurred. Please check your credentials.", 'error');
        }
    } catch(err) {
        console.error("Network or server connection error:", err);
        showStatusMessage("Server error. Please ensure your backend is running and reachable.", 'error');
    } finally {
        submitButton.classList.remove('loading');
    }
});

// Initial setup to ensure authToggle link works on page load
toggleAuthMode(false);
</script>
</body>
</html>
